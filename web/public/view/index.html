<!doctype html>
<html>
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
<meta name="viewport" content="width=device-width, initial-scale=1">
    <title></title>
    <script src="{baseurl}/css/jquery-3.2.1.min.js"></script>
    <link href="{baseurl}/css/bootstrap.min.css" rel="stylesheet" type="text/css" />

    <script src="{baseurl}/css/JSON-to-Table.min.1.0.0.js"></script>

</head>
<body>

<div class="container">
<form  role="form" class="form-inline" id="formsearch" >
    <fieldset>


        <div class="form-group mx-sm-3 mb-2">
            <label class="sr-only" > Employee Name </label>
            <input name="em_name" type="text" required="required" class="form-control" id="em_name" placeholder="Employee Name" value=""  maxlength="100"  />
        </div>

        <div class="form-group mx-sm-3 mb-2">
            <label class="sr-only" >Event Name </label>
            <input maxlength="100" type="text" name="ev_name" id="ev_name" required="required" class="form-control" placeholder="Event Name" />
        </div>


        <div class="form-group mx-sm-3 mb-2">
            <label class="sr-only" >Event Date </label>
                <input maxlength="100" type="text" name="ev_date" id="ev_date" required="required" class="form-control" placeholder="Event Date" />
        </div>
        <button class="btn btn-primary mb-2" id="searchbtn" type="button" >Search</button>
        <button class="btn btn-primary mb-2" id="importbtn" type="button" >import</button>

    </fieldset>
</form>
<div class="table margin-bottom" ></div>



</div>
<script type="text/javascript">

    $(document).ready(function () {
        var tabelconfig="{//GeneralStyleforTableborderWidth:'1px',borderStyle:'solid',borderColor:'#DDDDDD',fontFamily:'Verdana,Helvetica,Arial,FreeSans,sans-serif',//TableHeaderStylethBg:'#F3F3F3',thColor:'#0E0E0E',thHeight:'30px',thFontFamily:'\"OpenSansCondensed\",sans-serif',thFontSize:'14px',thTextTransform:'capitalize',//TableBody/RowStyletrBg:'#fff',trColor:'#0E0E0E',trHeight:'25px',trFontFamily:'\"OpenSans\",sans-serif',trFontSize:'13px',//TableBody'sColumnStyletdPaddingLeft:'10px',tdPaddingRight:'10px'}"

        function sumFunc() {
            var sum=0;
            $(document).find('table tr td:nth-child(6)').each(function() {
                var customerId = $(this).text();

                sum+= parseFloat(customerId);

                //   console.log(customerId);

            });
            $('table').append('<tr><td>Sum:</td><td>'+sum.toFixed(3)+'</td></tr>');
        }
//=========================================================
     function getdata(datareq=''){

            $.ajax({
                type: 'POST',
                url: '{baseurl}/getdata/',
                data: datareq,
                success: function (resultData) {
                    $('.table').createTable(resultData, tabelconfig);
                    sumFunc();
                }
            });
        }
 //=========================================================
        getdata('');
//========================================================================
        $(document).on("click","#searchbtn", function() {
            var datareq = $('#formsearch').serialize();
            getdata(datareq);
         });

 //========================================================================
        $(document).on("click","#importbtn", function() {
            $.ajax({
                type: 'GET',
                url: '{baseurl}/import/',
                success: function (resultData) {
                    $("#importbtn").fadeOut();
                    alert("import complete");
                    getdata('');
                }

            });
        });


  });
</script>

</body>
</html>
